version: 2

models:
  - name: dim_patients
    description: "{{ doc('stg_patients') }}"
    columns:
      - name: patient_id
        description: "{{ doc('patient_id') }}"
        tests:
          - unique
          - not_null

      - name: patient_gender
        description: "{{ doc('patient_gender') }}"

      - name: patient_birth_date
        description: "{{ doc('patient_birth_date') }}"

      - name: patient_last_name
        description: "{{ doc('patient_last_name') }}"

      - name: patient_first_name
        description: "{{ doc('patient_first_name') }}"

      - name: patient_deceased_at
        description: "{{ doc('patient_deceased_at') }}"

      - name: patient_country
        description: "{{ doc('patient_country') }}"

      - name: patient_state
        description: "{{ doc('patient_state') }}"

      - name: patient_postal_code
        description: "{{ doc('patient_postal_code') }}"

      - name: patient_city
        description: "{{ doc('patient_city') }}"

      - name: patient_address
        description: "{{ doc('patient_address') }}"

      - name: first_visit_condition_text
        description: "{{ doc('condition_text') }}"

      - name: first_condition_date
        description: The date when conditions was first assigned to a patient.

      - name: first_encounter_date
        description: The first encounter date of a patient.

      - name: last_encounter_date
        description: The last encounter date of a patient.

      - name: total_encounters
        description: The total number of encounters recorded for a patient.

      - name: total_count_of_unique_conditions
        description: The total lifetime count of unique conditions for each patient.

      - name: total_conditions_on_first_visit
        description: The total number of conditions recorded for a patient during the first visit.

      - name: age
        description: The current age of the patients.

      - name: age_when_deceased
        description: The age of the patients when they passed away.
