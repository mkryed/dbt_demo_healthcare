version: 2

macros:
  - name: calculate_age
    description: >
      This macros calculates the accurate age in years based on a given date using the date_diff
      function in BigQuery. The macros takes in two arguments patient_birth_date and date_2. patient_birth_date is
      the date of birth and by default date_2 is current_date. Unless otherwise specified, the macros only calculates
      the current age when patient_birth_date is provided. Upon providing date_2, the macros overrides the currrent_date
      and calculates the difference. If only patient_birth_date is provided, the current age is calculated.
      If patient_birth_date and date_2 are provided, the age at death is calculated.
    arguments:
      - name: patient_birth_date
        type: string
        description: This date represents the date of birth.
      - name: date_2
        type: string
        description: >
          By default, this argument is not provided, and it defaults to the current date. Overriding this
          argument allows calculating the age of individuals at a specific date, such as deceased patients.
